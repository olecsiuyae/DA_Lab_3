# Система резервування квитків

Клієнт-серверний додаток на основі gRPC для резервування квитків.

## Структура проєкту

Рішення складається з таких проєктів:

- **TicketService**: gRPC-сервіс для управління квитками та їх доступністю
- **ReservationService**: gRPC-сервіс для управління резервуваннями, який спілкується з TicketService
- **TicketReservationClient**: Консольний клієнтський додаток, який взаємодіє з обома сервісами
- **SharedModels**: Спільна бібліотека, що містить proto-файли та моделі
- **PeerRegistry**: Сервіс реєстрації пірів для децентралізованої роботи

## Функції

- Перегляд доступних квитків
- Перегляд деталей квитка
- Створення резервувань
- Перегляд резервувань клієнта
- Скасування резервувань
- Підтвердження оплати

## Схема комунікації

### Централізована версія
1. Клієнт спілкується з обома сервісами: TicketService та ReservationService
2. ReservationService спілкується з TicketService для перевірки доступності квитків та резервування/звільнення квитків
3. Вся комунікація здійснюється за допомогою gRPC

### Децентралізована версія
1. Кожен учасник системи є піром, який може пропонувати квитки та робити резервування
2. Піри знаходять один одного через реєстр пірів (PeerRegistry)
3. Дані підписуються за допомогою електронного цифрового підпису для забезпечення автентичності
4. Піри спілкуються безпосередньо між собою та досягають консенсусу щодо стану квитків

## Як запустити

### Централізована версія
1. Відкрийте рішення у Visual Studio або вашому улюбленому IDE
2. Зберіть рішення
3. Спочатку запустіть TicketService:
   ```
   cd TicketService
   dotnet run
   ```
4. Запустіть ReservationService у новому терміналі:
   ```
   cd ReservationService
   dotnet run
   ```
5. Запустіть клієнтський додаток у новому терміналі:
   ```
   cd TicketReservationClient
   dotnet run
   ```

### Децентралізована версія
1. Запустіть реєстр пірів:
   ```
   cd PeerRegistry
   dotnet run
   ```
2. Запустіть кілька екземплярів пірів у різних терміналах:
   ```
   cd TicketPeer
   dotnet run -- --port 5001 --registry http://localhost:5000
   ```
   ```
   cd TicketPeer
   dotnet run -- --port 5002 --registry http://localhost:5000
   ```
3. Взаємодійте з будь-яким піром через клієнтський додаток:
   ```
   cd TicketPeerClient
   dotnet run -- --peer http://localhost:5001
   ```

## Тестування

### Тестування цілісності даних
1. Запустіть систему в децентралізованому режимі
2. Спробуйте змінити дані квитка без правильного підпису:
   ```
   cd TestClient
   dotnet run -- --test tamper-data
   ```
3. Перевірте, що змінені дані не приймаються іншими пірами

### Тестування розподіленого консенсусу
1. Запустіть кілька пірів
2. Зарезервуйте квиток через один пір
3. Перевірте, що всі піри мають узгоджену інформацію про статус квитка

## Використані технології

- .NET 6.0
- gRPC
- Protocol Buffers
- SignalR (для P2P комунікації)
- System.Security.Cryptography (для ЕЦП)
- C#
